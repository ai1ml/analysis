tabA, tabB, tabC, tabD = st.tabs([
    "Overview", "Efficiency Opportunities", "TA Comparison", "Recommended Actions"
])

# ===== 1) OVERVIEW =====
with tabA:
    v = "ec2_ops_ba_summary"
    q = f"""
    SELECT *
    FROM {v}
    WHERE {ec2_where_for_view(v)}
    ORDER BY ondemand_cost_usd DESC NULLS LAST
    """
    _df(q, title="BA Summary (OnDemand vs Spot vs Savings Potential)")

# ===== 2) EFFICIENCY OPPORTUNITIES =====
with tabB:
    v = "ec2_spot_candidates"
    q = f"SELECT * FROM {v} WHERE {ec2_where_for_view(v)} ORDER BY est_monthly_savings_usd DESC NULLS LAST"
    _df(q, title="OnDemand â†’ Spot Candidates")

    v = "ec2_schedule_candidates"
    q = f"SELECT * FROM {v} WHERE {ec2_where_for_view(v)} ORDER BY est_monthly_savings_usd DESC NULLS LAST"
    _df(q, title="Schedule (Off-Hours) Candidates")

    v = "ec2_rightsize_candidates"
    q = f"SELECT * FROM {v} WHERE {ec2_where_for_view(v)} ORDER BY est_monthly_savings_usd DESC NULLS LAST"
    _df(q, title="Rightsize (CPU <30%) Candidates")

# ===== 3) TA COMPARISON =====
with tabC:
    v = "ec2_ta_rightsize_comparison"
    q = f"SELECT * FROM {v} WHERE {ec2_where_for_view(v)} ORDER BY ours_est_monthly_savings_usd DESC NULLS LAST"
    _df(q, title="Rightsize: Ours vs Trusted Advisor")

# ===== 4) RECOMMENDED ACTIONS =====
with tabD:
    v = "ec2_ops_actions_ranked"
    q = f"SELECT * FROM {v} WHERE {ec2_where_for_view(v)} ORDER BY est_monthly_savings_usd DESC NULLS LAST"
    _df(q, title="Recommended Actions (Ranked)")
